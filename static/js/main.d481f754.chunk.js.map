{"version":3,"sources":["react-request-hook/request.ts","react-request-hook/requestContext.ts","react-request-hook/useRequest.ts","react-request-hook/useResource.ts","Sandbox.tsx","api.ts","styles.tsx","components/UserList.tsx","useDebounce.tsx","components/SearchUser.tsx","components/UserListCached.tsx","components/SearchUserOptimized.tsx","App.tsx","store.ts","index.tsx"],"names":["request","config","paylaod","RequestContext","createContext","RequestProvider","Provider","Consumer","useRequest","fn","axiosInstance","useContext","_useState","useState","_useState2","Object","slicedToArray","sources","setSources","mountedRef","useRef","removeCancelToken","cancelToken","current","prevSources","filter","source","token","useCallback","apply","arguments","axios","CancelToken","ready","concat","toConsumableArray","objectSpread","then","response","data","catch","error","message","code","status","isCancel","createRequestError","cancel","clear","length","map","clearRef","useEffect","hasPending","useResource","defaultParams","_useRequest","_useRequest2","_useRequest2$","createRequest","setError","_useState3","_useState4","setData","_len","args","Array","_key","_createRequest","canceller","isLoading","Sandbox","props","dispatch","useDispatch","count","setCount","instance","setInstance","log","type","name","onRequest","n","onSuccess","onError","Promise","reject","next","create","baseURL","interceptors","use","react_default","a","createElement","value","Fragment","children","api","getUsers","page","undefined","method","url","searchUser","searchText","Header","styled","div","_templateObject","Main","main","_templateObject2","Container","_templateObject3","Row","_templateObject4","alpha","Styles","createGlobalStyle","_templateObject5","UserList","setPage","usersList","setUsersList","_useResource","prevItems","Box","flex","overflow","pad","InfiniteScroll","step","items","onMore","p","user","index","key","id","Image","src","avatar","Text","size","useDebounce","delay","currentValue","setCurrentValue","interval","clean","clearInterval","setTimeout","SearchUser","input","setInput","TextInput","onChange","e","target","UserListCached","mapStateToProps","state","usersListCached","currentPage","_useResource2","_useMappedState","useMappedState","SearchUserOptmized","_useResource2$","routes","label","path","withRouter","react","Menu","r","onClick","history","push","Route","render","Sandbox_Sandbox","UserListCached_UserListCached","UserList_UserList","exact","Redirect","to","initialState","store","createStore","action","assign","window","__REDUX_DEVTOOLS_EXTENSION__","ReactDOM","index_es","BrowserRouter","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.d481f754.chunk.js","sourcesContent":["import axios, {AxiosRequestConfig, AxiosError, Canceler} from 'axios';\n\nexport type Arguments<T> = T extends (...args: infer A) => any ? A : never;\n\nexport interface Resource<TPayload> extends AxiosRequestConfig {\n  payload?: TPayload;\n}\n\nexport interface Request {\n  (...args: any[]): Resource<any>;\n}\n\nexport type Payload<TRequest extends Request> = ReturnType<TRequest>['payload'];\n\nexport interface RequestFactory<TRequest extends Request> {\n  (...args: Arguments<TRequest>): {\n    cancel: Canceler;\n    ready: () => Promise<Payload<TRequest>>;\n  };\n}\n\nexport interface RequestDispatcher<TRequest extends Request> {\n  (...args: Arguments<TRequest>): Canceler;\n}\n\n// Normalize the error response returned from our hooks\nexport interface RequestError {\n  data: any;\n  message: string;\n  code?: string;\n  isCancel: boolean;\n}\n\nexport function request<TPayload>(\n  config: AxiosRequestConfig,\n  // we use 'payload' to enable non-ts applications to leverage type safety and\n  // as a argument sugar that allow us to extract the payload type easily\n  // @ts-ignore\n  paylaod?: TPayload,\n  ): Resource<TPayload> {\n  return config;\n}\n\nexport function createRequestError(error: AxiosError): RequestError {\n  const data = error.response ? error.response.data : null;\n  return {\n    data,\n    message: error.message,\n    code:\n      (data && data.code) ||\n      error.code ||\n      (error.response && error.response.status),\n    isCancel: axios.isCancel(error),\n  };\n}\n","import {createContext} from 'react';\nimport {AxiosInstance} from 'axios';\n\nexport const RequestContext = createContext<AxiosInstance | null>(null);\nexport const RequestProvider = RequestContext.Provider;\nexport const RequestConsumer = RequestContext.Consumer;\n","import {useState, useCallback, useContext, useRef, useEffect} from 'react';\nimport axios, {\n  AxiosError,\n  CancelTokenSource,\n  Canceler,\n  CancelToken,\n} from 'axios';\nimport {\n  createRequestError,\n  RequestFactory,\n  Request,\n  Arguments,\n} from './request';\nimport {RequestContext} from './requestContext';\n\nexport type UseRequestResult<TRequest extends Request> = [\n  {\n    hasPending: boolean;\n    clear: Canceler;\n  },\n  RequestFactory<TRequest>\n];\n\nexport function useRequest<TRequest extends Request>(\n  fn: TRequest,\n): UseRequestResult<TRequest> {\n  const axiosInstance = useContext(RequestContext);\n  const [sources, setSources] = useState<CancelTokenSource[]>([]);\n  const mountedRef = useRef(true);\n\n  const removeCancelToken = (cancelToken: CancelToken) => {\n    if (mountedRef.current) {\n      setSources(prevSources =>\n        prevSources.filter(source => source.token !== cancelToken),\n      );\n    }\n  };\n\n  const request = useCallback(\n    (...args: Arguments<TRequest> | any[]) => {\n      const config = fn(...args);\n      const source = axios.CancelToken.source();\n\n      const ready = () => {\n        setSources(prevSources => [...prevSources, source]);\n        return axiosInstance!({...config, cancelToken: source.token})\n          .then(response => {\n            removeCancelToken(source.token);\n            return response.data;\n          })\n          .catch((error: AxiosError) => {\n            removeCancelToken(source.token);\n            throw createRequestError(error);\n          });\n      };\n\n      return {\n        ready,\n        cancel: source.cancel,\n      };\n    },\n    [axiosInstance],\n  );\n\n  const clear = useCallback(\n    (message?: string) => {\n      if (sources.length > 0) {\n        sources.map(source => source.cancel(message));\n        /* istanbul ignore next */\n        if (mountedRef.current) {\n          setSources([]);\n        }\n      }\n    },\n    [sources],\n  );\n\n  const clearRef = useRef(clear);\n  useEffect(() => {\n    clearRef.current = clear;\n  });\n\n  useEffect(() => {\n    return () => {\n      clearRef.current();\n      mountedRef.current = false;\n    };\n  }, []);\n\n  return [\n    {\n      clear: (message?: string) => clearRef.current(message),\n      hasPending: sources.length > 0,\n    },\n    request,\n  ];\n}\n","import {useEffect, useState, useCallback} from 'react';\nimport {Canceler} from 'axios';\nimport {useRequest} from './useRequest';\nimport {\n  Payload,\n  RequestError,\n  Request,\n  RequestDispatcher,\n  Arguments,\n} from './request';\n\nexport type UseResourceResult<TRequest extends Request> = [\n  {\n    data: Payload<TRequest> | null;\n    error: RequestError | null;\n    isLoading: boolean;\n    cancel: Canceler;\n  },\n  RequestDispatcher<TRequest>\n];\n\nexport function useResource<TRequest extends Request>(\n  fn: TRequest,\n  defaultParams?: Arguments<TRequest>,\n): UseResourceResult<TRequest> {\n  const [{clear, hasPending}, createRequest] = useRequest(fn);\n  const [error, setError] = useState<RequestError | null>(null);\n  const [data, setData] = useState<Payload<TRequest> | null>(null);\n\n  const request = useCallback((...args: Arguments<TRequest> | any[]) => {\n    clear('A new request has been made before completing the last one');\n    const {ready, cancel} = createRequest(...(args as Arguments<TRequest>));\n    ready()\n      .then(data => {\n        setData(data);\n      })\n      .catch((error: RequestError) => {\n        if (!error.isCancel) {\n          setError(error);\n        }\n      });\n    return cancel;\n  }, []);\n\n  useEffect(() => {\n    let canceller: Canceler;\n    if (defaultParams) {\n      canceller = request(...defaultParams);\n    }\n    return () => {\n      if (canceller) {\n        canceller();\n      }\n    };\n  }, defaultParams);\n\n  return [\n    {\n      data,\n      error,\n      cancel: clear,\n      isLoading: hasPending,\n    },\n    request,\n  ];\n}\n","import React, {useState, useEffect} from 'react';\nimport axios, {\n  AxiosRequestConfig,\n  AxiosResponse,\n  AxiosError,\n  AxiosInstance,\n} from 'axios';\nimport {RequestProvider} from './react-request-hook';\nimport {useDispatch} from 'redux-react-hook';\n\nconst BASE_URL = 'https://5c564f1ed293090014c0ee3e.mockapi.io/api/v1';\n\nexport const Sandbox: React.FC<{name: string}> = props => {\n  const dispatch = useDispatch();\n  const [count, setCount] = useState(0);\n  const [instance, setInstance] = useState<AxiosInstance | null>(null);\n\n  const log = (status: string) =>\n    dispatch({\n      type: `@${props.name} [${status}]`,\n    });\n\n  const onRequest = (config: AxiosRequestConfig) => {\n    setCount(n => n + 1);\n    log('START');\n    return config;\n  };\n\n  const onSuccess = (response: AxiosResponse) => {\n    log('SUCCESS');\n    return response;\n  };\n\n  const onError = (error: AxiosError) => {\n    if (axios.isCancel(error)) {\n      log('CANCEL');\n    } else {\n      log('ERROR');\n    }\n\n    return Promise.reject(error);\n  };\n\n  useEffect(() => {\n    const next = axios.create({baseURL: BASE_URL});\n    next.interceptors.request.use(onRequest);\n    next.interceptors.response.use(onSuccess, onError);\n    setInstance(() => next);\n  }, []);\n\n  if (!instance) {\n    return null;\n  }\n\n  return (\n    <RequestProvider value={instance}>\n      <>\n        <span>REQUESTS: {count}</span>\n        {props.children}\n      </>\n    </RequestProvider>\n  );\n};\n","import {request} from './react-request-hook';\n\nexport type User = {\n  id: number;\n  createdAt: string;\n  avatar: string;\n  name: string;\n};\n\nconst api = {\n  getUsers: (page: number = 1) => {\n    return request<User[]>({\n      method: 'GET',\n      url: `/users?limit=10&page=${page}`,\n    });\n  },\n\n  searchUser: (searchText: string) => {\n    return request<User[]>({\n      method: 'GET',\n      url: `/users?filter=${searchText}&limit=10`,\n    });\n  },\n};\n\nexport default api;\n","import styled, {createGlobalStyle} from 'styled-components';\n\nexport const Header = styled.div`\n  display: flex;\n  flex-direction: row;\n  min-width: 100%;\n  min-height: 48px;\n`;\n\nexport const Main = styled.main`\n  display: flex;\n  max-width: 960px;\n  width: 100%;\n  margin: 6rem;\n  padding: 1rem;\n  flex-grow: 1;\n  flex-direction: column;\n  background-color: white;\n  border-radius: 6px;\n  overflow: hidden;\n  box-shadow: 0 16px 38px -12px rgba(0, 0, 0, 0.56),\n    0 4px 25px 0px rgba(0, 0, 0, 0.12), 0 8px 10px -5px rgba(0, 0, 0, 0.2);\n\n  @media (max-width: 960px) {\n    max-width: calc(100% - 16px);\n    padding: 8px;\n  }\n`;\n\nexport const Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  overflow-y: auto;\n`;\n\nexport const Row = styled.div<{alpha?: number}>`\n  min-height: 128px;\n  margin: 8px;\n  padding: 16px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  border-radius: 4px;\n  background-color: rgba(\n    253,\n    247,\n    255,\n    ${props => (props.alpha ? (props.alpha % 101) / 15 : 0.1)}\n  );\n\n  img {\n    border-radius: 100%;\n    height: 64px;\n    margin-right: 12px;\n  }\n`;\n\nexport const Styles = createGlobalStyle`\n   * {\n    border: 0;\n    box-sizing: inherit;\n    -webkit-font-smoothing: antialiased;\n    font-weight: inherit;\n    margin: 0;\n    outline: 0;\n    padding: 0;\n    text-decoration: none;\n    text-rendering: optimizeLegibility;\n    -webkit-appearance: none;\n    -moz-appearance: none;\n  }\n\n  html {\n    display: flex;\n    height: 100%;\n    width: 100%;\n    box-sizing: border-box;\n    font-size: 16px;\n    line-height: 1.5;\n    background-color: #ffffff;\n    color: #16171a;\n    padding: 0;\n    margin: 0;\n    -webkit-font-smoothing: antialiased;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial,\n      sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';\n\n    max-width: 100%;\n  }\n\n  body {\n    flex-direction: column;\n    box-sizing: border-box;\n    min-width: 100%;\n    min-height: 100%; \n    -webkit-overflow-scrolling: touch;\n    display: flex;\n  }\n\n  a {\n    color: currentColor;\n    text-decoration: none;\n  }\n\n  a:hover {\n    cursor: pointer;\n  }\n\n  #root {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    flex: 1;\n    background: linear-gradient(135deg, #5C33B8, #A267D7);\n  }\n`;\n","import React, {useState, useEffect} from 'react';\nimport {Box, InfiniteScroll, Text, Image} from 'grommet';\nimport {useResource} from '../react-request-hook';\nimport api, {User} from '../api';\nimport {Row} from '../styles';\n\nexport const UserList: React.FC = () => {\n  const [page, setPage] = useState(1);\n  const [usersList, setUsersList] = useState<User[]>([]);\n  const [response] = useResource(api.getUsers, [page]);\n\n  function onMore() {\n    if (page < 10) {\n      setPage(p => p + 1);\n    }\n  }\n\n  useEffect(() => {\n    if (response.data) {\n      setUsersList(prevItems => [...prevItems, ...response.data!]);\n    }\n  }, [response.data]);\n\n  return (\n    <Box flex overflow=\"auto\" pad=\"medium\">\n      <InfiniteScroll step={9} items={usersList} onMore={onMore}>\n        {(user: User, index: number) => (\n          <Row key={user.id} alpha={index + 1}>\n            <Image src={user.avatar} />\n            <Text size=\"large\">{user.name}</Text>\n          </Row>\n        )}\n      </InfiniteScroll>\n    </Box>\n  );\n};\n","import {useState, useEffect, useRef} from 'react';\n\nexport default function useDebounce(value: string, delay: number = 600) {\n  const [currentValue, setCurrentValue] = useState(value);\n  const interval = useRef<NodeJS.Timeout | null>(null);\n\n  const clean = () => {\n    if (interval.current !== null) {\n      clearInterval(interval.current);\n    }\n  };\n\n  useEffect(() => {\n    interval.current = setTimeout(() => {\n      setCurrentValue(value);\n    }, delay);\n    return clean;\n  }, [value, delay]);\n\n  useEffect(() => clean, []);\n\n  return currentValue;\n}\n","import React, {useState} from 'react';\nimport {TextInput, Image, Text} from 'grommet';\nimport {useResource} from '../react-request-hook';\nimport useDebounce from '../useDebounce';\nimport api from '../api';\nimport {Row} from '../styles';\n\nexport default function SearchUser() {\n  const [input, setInput] = useState<string>('Gabriel');\n  const searchText = useDebounce(input);\n  const [response] = useResource(api.searchUser, [searchText]);\n\n  return (\n    <>\n      <TextInput value={input} onChange={e => setInput(e.target.value)} />\n      {response.data &&\n        response.data.map((user, index) => (\n          <Row key={user.id} alpha={index + 1}>\n            <Image src={user.avatar} />\n            <Text size=\"large\">{user.name}</Text>\n          </Row>\n        ))}\n    </>\n  );\n}\n","import React, {useEffect, useCallback} from 'react';\nimport {Box, InfiniteScroll, Text, Image} from 'grommet';\nimport {useResource} from '../react-request-hook';\nimport api, {User} from '../api';\nimport {Row} from '../styles';\nimport {useMappedState, useDispatch} from 'redux-react-hook';\nimport {State} from '../store';\n\nexport const UserListCached: React.FC = () => {\n  const mapStateToProps = useCallback(\n    (state: State) => ({\n      usersList: state.usersListCached.data,\n      page: state.usersListCached.currentPage,\n    }),\n    [],\n  );\n\n  const [response, getUsers] = useResource(api.getUsers);\n  const {page, usersList} = useMappedState(mapStateToProps);\n  const dispatch = useDispatch();\n\n  function onMore() {\n    if (page < 10) {\n      getUsers(page + 1);\n    }\n  }\n\n  useEffect(() => {\n    if (page === 0) {\n      getUsers(1);\n    }\n  }, [])\n\n  useEffect(() => {\n    if (response.data) {\n      dispatch({type: 'CACHE_USERS', page: page + 1, data: response.data});\n    }\n  }, [response.data]);\n\n  return (\n    <Box flex overflow=\"auto\" pad=\"medium\">\n      <InfiniteScroll step={9} items={usersList} onMore={onMore}>\n        {(user: User, index: number) => (\n          <Row key={user.id} alpha={index + 1}>\n            <Image src={user.avatar} />\n            <Text size=\"large\">{user.name}</Text>\n          </Row>\n        )}\n      </InfiniteScroll>\n    </Box>\n  );\n};\n","import React, {useState, useEffect} from 'react';\nimport useDebounce from '../useDebounce';\nimport {useResource} from '../react-request-hook';\nimport {TextInput, Image, Text} from 'grommet';\nimport api from '../api';\nimport {Row} from '../styles';\n\nexport function SearchUserOptmized() {\n  const [input, setInput] = useState<string>('Gabriel');\n  const searchText = useDebounce(input);\n  const [{data, cancel}] = useResource(api.searchUser, [searchText]);\n\n  // Different from SearchUser, we trigger the cancel as soon as the input changes\n  useEffect(() => {\n    if (searchText !== input) {\n      cancel();\n    }\n  }, [input]);\n\n  return (\n    <>\n      <TextInput value={input} onChange={e => setInput(e.target.value)} />\n      {data &&\n        data.map((user, index) => (\n          <Row key={user.id} alpha={index + 1}>\n            <Image src={user.avatar} />\n            <Text size=\"large\">{user.name}</Text>\n          </Row>\n        ))}\n    </>\n  );\n}\n","import * as React from 'react';\nimport {Sandbox} from './Sandbox';\nimport {UserList} from './components/UserList';\nimport {\n  Route,\n  Redirect,\n  withRouter,\n  RouteComponentProps,\n} from 'react-router-dom';\nimport SearchUser from './components/SearchUser';\nimport {Styles, Main, Header, Container} from './styles';\nimport {Menu} from 'grommet';\nimport {UserListCached} from './components/UserListCached';\nimport {SearchUserOptmized} from './components/SearchUserOptimized';\n\nconst routes = [\n  {label: 'Users List', path: '/users-list'},\n  {label: 'Users List Cached', path: '/users-list-cached'},\n  {label: 'Search User', path: '/search-user'},\n  {label: 'Search User Optmized', path: '/search-user-optmized'},\n];\n\nfunction App(props: RouteComponentProps) {\n  return (\n    <>\n      <Styles />\n\n      <Main>\n        <Header>\n          <Menu\n            label=\"Examples\"\n            items={routes.map(r => ({\n              label: r.label,\n              onClick: () => props.history.push(r.path),\n            }))}\n          />\n        </Header>\n\n        <Container>\n          <Route\n            path=\"/users-list-cached\"\n            render={() => (\n              <Sandbox name=\"users-list-cached\">\n                <UserListCached />\n              </Sandbox>\n            )}\n          />\n\n          <Route\n            path=\"/users-list\"\n            render={() => (\n              <Sandbox name=\"users-list\">\n                <UserList />\n              </Sandbox>\n            )}\n          />\n\n          <Route\n            path=\"/search-user\"\n            render={() => (\n              <Sandbox name=\"search-user\">\n                <SearchUser />\n              </Sandbox>\n            )}\n          />\n\n          <Route\n            path=\"/search-user-optmized\"\n            render={() => (\n              <Sandbox name=\"search-user-optmized\">\n                <SearchUserOptmized />\n              </Sandbox>\n            )}\n          />\n          <Route exact path=\"/\" render={() => <Redirect to=\"/users-list\" />} />\n        </Container>\n      </Main>\n    </>\n  );\n}\n\nexport default withRouter(App);\n","import {createStore} from 'redux';\nimport {User} from './api';\n\nconst initialState = {\n  usersListCached: {\n    currentPage: 0 as number,\n    data: [] as User[],\n  },\n};\n\nexport type CACHE_USERS = {\n  type: 'CACHE_USERS';\n  page: number;\n  data: User[];\n};\n\nexport type State = typeof initialState;\n\nfunction reducer(state = initialState, action: any) {\n  if (action.type === 'CACHE_USERS') {\n    return Object.assign({}, state, {\n      usersListCached: {\n        currentPage: action.page,\n        data: [...state.usersListCached.data, ...action.data],\n      },\n    });\n  }\n  return state;\n}\n\nconst store = createStore(\n  reducer,\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__(),\n);\n\nexport default store;\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport {StoreContext} from 'redux-react-hook';\nimport {BrowserRouter} from 'react-router-dom';\nimport App from './App';\nimport store from './store';\n\nReactDOM.render(\n  <StoreContext.Provider value={store}>\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  </StoreContext.Provider>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}